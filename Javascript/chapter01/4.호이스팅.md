# 호이스팅 



실행 컨텍스트 생성시 렉시컬 스코프 내의 선언이 끌어올려 지는게 호이스팅이다



이 단어만으로 설명이 가능한것이 호이스팅인데

사실 여기서 어려운 단어인 `실행 컨텍스트` 와 `렉시컬 스코프` 의 상세한 기본 스펙을 알려면 더오래걸려요.

사실 우리는 실행이 되는 순서와 그리고 일단 어느정도 감을 찾는것이 우선입니다.

스펙은 그이후에요, 저도 코드를볼때 저런거 생각안하고 보면 결과가 이거겠지 하고 해석해서 결과물을 도출합니다.

스펙 공부할꺼면 컴퓨터 동작원리 부터 배워야지 이것부터 배우는것도 넌센스죠..

그럼 `실행 컨텍스트` 와 `렉시컬 스코프` 에 대해서 알아보도록 하겠습니다. 



## 1. 실행 컨텍스트



사실 여기서 설명을 정확하게 하려면 어려운말 써가면서 설명이 가능하긴 하지만.

짧고 간단하게 이해 시키는 방법은 바로 `heep` 안에 있는 선언부분 저장이 `실행 컨텍스트` 이다.



## 2. 렉시컬 스코프



렉시컬 스코프 또한 어려운말 써가면서 설명이 가능하긴 하지만.

짧게 설명하자면 `지역 변수` , `전역 변수` 기준으로 생각하면 된다. 



## 3. 예제 문제



간단한 코드로 본인이 실행 컨텍스트와 렉시컬 스코프를 아는지 공부해보도록 합시다.

> var 을 사용한 이유는 차후 호이스팅 설명을 위해서 써놓음.

```javascript
var x = 'ingoo'

function inner() {
  var x = 'hello'
  console.log(x)
}

inner() 
```



이 코드의 실행 결과를 아는가? -> `Yes`

실행 컨텍스트를 아는가 -> `no`

렉시컬 스코프를 아는가 -> `no` 



하지만 여기에 렉시컬 스코프와 실행 컨텍스트가 다 담겨져있습니다.

하나하나 배워서. 어려울 뿐이지. 사실 하나로 묶어서 설명하는게 더 쉬운거같아요.



**해설**

```javascript
var x = 'ingoo'

function inner() {
  var x = 'hello'
  console.log(x)
}

inner() 
```



우리가 배웠던 `콜스택`  에 대해서 다시 생각해 보도록 하죠 

`heep` 이라는 공간과 `call stack` 이라는 공간이있고.

그리고 이 자바스크립트가 실행되었을때

`Anonymous` 함수가 실행 즉 익명함수가 실행되죠 



이함수가 실행되어서 `선언 부분만 실행을 시킨다고 했습니다` 기억나실까요 ?

이부분이 실행 컨텍스트 입니다.



즉 힙에 쌓이는 구조가 실행 컨텍스트다~ 이말입니다.

콜스택에 익명함수가 실행되면서 한줄한줄 코드를 읽기 시작합니다.



**익명함수가 실행시키는 코드 순서**



**1. x 변수 선언**

```javascript
var x = 'ingoo' // X 라는 변수가 ingoo라는 값을 가지고있다.
```



**2. inner 함수 선언**

```javascript
function inner() {
  var x = 'hello'
  console.log(x)
}
```



**3. inner() 함수 호출**

```javascript
inner()
```



**실행컨텍스트**

```javascript
// 0001 메모리에는 
x 라는 이름에 ingoo를 담습니다.

// 0002 메모리에는
inner 라는 메모리에 
{
  var x = 'hello',
  console.log(x)
}
를 담습니다.

선언부분에서 데이터를 저장할 공간은 힙에 저장되니깐 (힙 === 실행컨텍스트)
inner() 함수 실행이지 선언이 아닙니다 이부분은 콜스택에 쌓이겠죠 ?
```



**콜스택**

```javascript
inner()
Anonymous()
```



콜스택이 쌓여있으니 이제 실행을 할 차례이죠? `스택`  형태이니 위에서부터 빼기 시작합니다.

`inner()` 코드안에 있는 코드를 실행 시켜야합니다.



이때 `실행컨텍스트` 에서 inner 라는 이름을 가진 친구가 있는지 확인해봅니다.

있군요 그리고 그녀석 안에있는 값을 실행을 시킵니다.

inner 안에 있는 녀석들은

```javascript
{
  var x = 'hello',
  console.log(x)
}
```



입니다. 이때부터는 `렉시컬 스코프` 개념이 들어갑니다.

또 이코드를 실행하니깐 

`선언` 부분과 `호출` 이 각각 하나씩 있네요,



그러면 실행컨텍스트 부분에 (Heep) 

다시 x 라는 변수가 들어갑니다.



**실행컨텍스트**

```javascript
// 현재 메모리는 0001, 00002 를 사용중입니다.
// 그렇다면 0003 에 넣어보도록 할게요.
0001 x ingoo
0002 inner {...}
0003 x hello 

// 어라? x 라는 이름이 두개가 생기죠 ? 이러면 안됩니다.
// 그래서 재가 설명하는 방식은 실제 메모리 동작은 아니지만 이렇게 이해하시는게 편해요.
0001 x ingoo
0002 inner {
  0001 x hello
}
            
// 0003 { x: 0004 }
// 0004 hello
            
// 즉 0002 안에서 메모리주소를 생성했다고 보시면 됩니다.
            

```





inner 를 실행중이였으니 선언부분을 `실행컨텍스트`에서 동작을 했구요.

이제 `console.log` 를 콜스택에 추가하면 되겠네요.



**콜스택**

```javascript
console.log(x) // <-- 이친구는 inner 함수 안에서 실행한 친구이기때문에. x라는 변수를 inner에서부터 찾습니다.
inner()
Anonymous()
```



console.log(x) 가 콜스택에 들어와서 먼저 할일을 내가 참조할 변수를 어떤걸 사용할지 이다.

기본적으로 x 라는 변수는 전역에도 저장하고있고(전역스코프), 그리고 inner 함수 안에서도 선언되어있다. 

둘중에 뭘 써야하냐?

**inner함수 호출(실행) 할때 안에(렉시컬 스코프) 코드영역 (문맥=컨텍스트) 에 있는지 찾아보고 만약 없다면 (실행컨텍스트)**

> inner 함수 실행컨텍스트 생성(호출)시 렉시컬 스코프 에 있으면 해당 변수를 실행 없다면 이전 실행컨텍스트에서
>
> 해당 변수 를 찾습니다.



`inner` 아래있는 `Anonymous` 쪽을 참조한다.  하지만 그쪽에도 없다면.. 없는변수이니.. 에러가 난다.. (스코프체인)



하지만 우리는 inner 함수 안에 존재하니깐. 변수를 호출하고 결과를 잘 출력할것이다.

```javascript
hello
```



우리는 하나의 코드로 `실행컨텍스트` , `렉시컬 스코프`, `스코프체인` 을 배웠습니다. 

이후 이제 진짜 문제인 `호이스팅` 을 배우도록 하겠습니다. 코드를 변경해보겠습니다.

```javascript
var x = 'ingoo'

function inner() {
  console.log(x)
  var x = 'hello'
}

inner() // undefined
```



```javascript
let x = 'ingoo'

function inner() {
  console.log(x)
  let x = 'hello'
}

inner() 

/*
Uncaught ReferenceError: Cannot access 'x' before initialization
    at inner (<anonymous>:4:15)
    at <anonymous>:8:1
*/
```



왜 `var` 는 undefined 이고 `let` 은 x에 대해 에러가 출력될까요 ?

그것은 바로 `호이스팅` 이 일어났기 떄문입니다.



이건 좀전의 `inner` 가 실행컨텍스트가 생길때 부터 설명이 이어져야합니다.

Inner 함수 호출시 `렉시컬 스코프(코드블럭)` 안에 있는 코드가 한줄 한줄 실행을 `실행컨텍스트` 생성입니다.

이때 ! 선언부분 호이스팅이 일어나는 키워드가 `var`  와 `function` 입니다.



즉 실행컨텍스트를 생성하기 전에 해당 코드블럭 내에 선언부분만 **먼저** 실행하는 것이 바로 `호이스팅` 입니다.

즉 이런식으로 코드가 변한다는거죠 

```javascript
function inner(){
  console.log(x)
  var x = 'hello'
}

// 실행컨텍스트를 생성할려고 한줄한줄 읽을때...

function inner(){
  console.log(x)
  --> var x = 'hello' 이부분을 먼저 찾고! (var와 function)만..
}

function inner() {
  var x
  console.log(x)
  x = 'hello' // 로 바꿔줍니다. 선언만 위로 올라가요..
}
```



이로서 호이스팅에 대해서 배웠습니다.

맨처음에 봤던 글을 볼까요 ?



**실행 컨텍스트 생성시 렉시컬 스코프 내의 선언이 끌어올려 지는게 호이스팅이다**

이제 이 글이 이해가 되나요 ?



그럼 여러가지 예제문제를 내볼게요



**문제 1.**

```javascript

function inner() {
  console.log(x)
}

var x = 'ingoo'
inner()
// 결과물을 설명하세요. 결과물만 말하지말고 설명을 하세요
```



**문제 2.**

```javascript
inner()
function inner(){
  console.log(x)
  let x = 'hello'
}

var x = 'ingoo'
```



**문제 3.**

```javascript
inner()
function inner(){
  x = 'hello'
	console.log(x)
}

console.log(x)
var x = 'ingoo'
```



**문제 4.**

```javascript
inner()
function inner(){
  x = 'hello'
	console.log(x)
}

var x = 'ingoo'
console.log(x)
```







프로그래밍 을 배운다는것은 이렇게 참조데이터 마냥, 타고타고 배워야합니다.

해당 내용을 배우기위해서 이전 지식이 없구나를 판단하고 이전에 배울까, 이후 더 추적하면서 배울까를..

`선택` 하셔야합니다. 



추적 할 힘이있다면 계속 배우는데 무리가 없는것이고, 추적할 힘이없다면 기본 지식이 부족하다는거죠

여기서 기본 지식을 더 습득할려면 더 공부해야겠구나 라는 생각을 하긴하지만

어떻게? 무엇을? ... 이럴거에요 그런데 사실 별거없어요 같은코드를 여러번치면서 해당 코드를 이해할려고해요

강의 아무리 보세요 이해가 되나 절대 안되지 그래놓고 난 재능이 없다고 생각할껄요?



