# Dapp 설계 방법

## 서비스 설계

### 1. 지갑(계정) 관리

- 지갑(계정)을 기준으로 이더를 보내고 받을수 있습니다.

- Smart Contract를 배포한 지갑을 관리해야할수도 있다.

- 그리고 많은 이더 즉 돈이 쌓여있다면, 하나의 계정에서 관리하는것보단, 멀티시그 월렛 으로 관리할수도있다.

  > https://luniverse.io/2021/05/28/multi-signature-wallet/?lang=ko 참고주소
  >
  > 일반적으로 암호화폐 지갑에는 크게 핫 월렛(HotWallet) 과 콜드 월렛(Cold Wallet) 이 있으며, 더 나아가 이더리움의 스마트 컨트랙트를 기반으로 한 멀티시그 월렛(Multi-Signature Wallet) 이 있다. 핫 월렛과 콜드 월렛은 인터넷에 연결되느냐 되지 않느냐의 차이로 구분을 하는데 그렇게 따지면 멀티시그 월렛은 핫 월렛으로 볼 수 있다.
  >
  > 멀티시그 월렛은 단일 서명을 통해 지갑에서 암호화폐를 출금하던 방식과 다르게 다중 서명을 통해 출금이 가능하도록 한 스마트 컨트랙트이다.
  >
  > 보통 개인이 사용하기보다는 거래소나 기업들처럼 공동의 자산을 보관하고 사용하는 곳에서 주로 사용된다.
  >
  > 이더리움은 트랜잭션 생성 시 하나의 서명만 할 수 있기 때문에 다중 서명(예를 들어 2 of 3)을 위해 스마트 컨트랙트를 이용한다.
  >
  > 이러한 방식의 멀티시그 월렛은 일반 월렛에 비해 보안이 더 우수하고 실수나 해킹으로 인한 사고를 방지할 수 있기를 기대하고 사용한다.
  >
  > 하지만 편의성이 부족하여 일반 월렛에 비해 사용하기가 쉽지 않고 해킹사고가 없었던 것도 아니다.

### 2. 아키텍처

- smart contract - front
  - 데이터를 모두 smart contract에서 저장하게되다면 너무 많은것을 사용하기 때문에 부담스러울수 있다.
- smart contract - server front
  - 데이터 모두가아니라, 중요한정보만 smart contract에 저장하고, 다소 덜중요한 내용들은 서버에 보내서 DB저장하는 방법이있다.

### 3. Code

- 코드를 실행하는데도 돈이 든다 : Smart Contract 가스비 발생
- 권한 관리 : 비지니스 로직이 복잡해지고, 할땐 아무나 함수를 실행하고 내용을 바꿔서 안되다보니, 권한설정이 중요합니다.
- 비니지스 로직 업데이트 : 처음에 한번 정해지고, 비지니스 로직이 업데이트하기가 힘듬 한번 배포하고 수정하는것이 아직까진 완벽하게 처리되는 방법이 없기 떄문에, 이것또한 하기전에 미리 생각하고 작업해야 합니다.
- 데이터 마이그레이션 : 다른 Smart contract에 저장된 정보를 새로 만든 Smart Contract에 이동하는것이 굉장히 어렵기때문에. 이런 일이 발생한다면 어떻게 처리할지 미리 생각하는것이 좋습니다.

### 4. 운영

- Public
- Private

## Lottery 규칙

`+ 3번째` 블록해쉬의 첫 두 글자 맞추기 `0xab......`

​ a. 유저가 던진 트랙잭션이 들어가는 블록 + 3 의 블록해쉬와 값을 비교

2. 팟머니
   1. 결과가 나왔을 때만 유저가 보낸 돈을 팟머니에 쌓기.
   2. 여러 명이 맞추었을 때는 가장 먼저 맞춘 사람이 팟머니를 가져간다.
   3. 두 글자 중 하나만 맞추었을 때는 보낸 돈을 돌려준다.
   4. 결과값을 검증할 수 없을 때에는 보낸 돈을 돌려준다.
