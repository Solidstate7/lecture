# Linux sudo 권한



## 권한



리눅스에서 어떤 명령어를 사용할 때 실행할 수 있는 권한이 필요합니다.

권한이 없는 경우에는 `Permission Denied` 경고를 받게 됩니다.

그러면 어떻게 권한을 받아서 명령어를 실행할 수 있을까요 ?



먼저, 리눅스 설치하면 모든 권한을 가지고있는  `root` 사용자가 생성됩니다. 

이 사용자는 모든 디렉토리, 파일 을 수정 삭제가 가능해서 좋은점도있지만

위험한점도 있습니다. 실수로 rm -rf 를 잘못쓴다면... 모든 파일이 날아갑니다.

그래서 최대한 `root` 사용자로 로그인하지 않는것이 좋습니다

사용자를 하나 만들고, 해당 사용자에게 `sudo` 권한을 부여하여 사용하는것이 좋습니다.



여러 사용자가 존재하는 경우 하나의 쉘에서 사용자를 변경할수 있습니다.

사용자 변경에 사용되는 명령어는 su (switch user) 인데, 여기서 하나 알아두셔야 할 것은 

`su` 와 `su -` 의 차이입니다.



**su 와 su- 차이**

- su <user> : 로그인 없이 사용자만 변경합니다. 기존에 로그인 했던 사용자의 환경설정을 그대로 사용합니다.
- su - <user> :  새로운 사용자로 변경하여 새로 로그인을 진행합니다. 따라서 로그인할 때 해당 사용자의 환경설정을 적용합니다.



## 실습



**su 실습**

```sh
$ whoami
$ echo $PATH
$ su user1
$ whoami
$ echo $PATH
```





**su - 실습**

```sh
$ whoami
$ echo $PATH
$ su - user1
$ whoami
$ echo $PATH
$ pwd
```



이렇게 미묘한 차이가 있기 떄문에, 사용자를 변경 하실 때는 용도에 맞게 알맞은 방식을 사용하시면 됩니다!

다만 두 경우 모두 변경하조가 하는 사용자의 패스워드는 알고 있어야 합니다. 

Su 명령어를 사용하시면 해당 작업에 대한 로그는 *journalctl -t su -f*  명령어로 확인하실 수 있습니다.

해당 명령어는 sudo 권한을 가지고 실행하셔야 합니다.





**journalctl -t su -f**

```sh
$ journalctl -t su -f
```



추가로 사용자가 변경될 때의 로그를 실시간으로 보고 싶으시다면 **tail -f /var/log/secure &** 를 사용하시고

su 명령어를 통해 사용자를 변경해보시기 바랍니다. 참고로 **&** 는 해당 명령어를 백그라운드에서 실행하겠다는 의미입니다.





**sudo 권한?**



sudo는 특정 명령을 실행할때 root 권한을 실행하겠다는 의미입니다. 실행할 당시에만 root 권한이 적용되고

이후에는 다시 사용자 권한으로 실행됩니다. sudo 명령어를 사용하기 위해서는 먼저 `/etc/sudoer` 에 등록되어 

있어야 하며, 명령어를 사용하는 사용자의 패스워드를 알고 있어야 합니다.



여기서 `/etc/sudoer` 파일은 `sudo` 권한에 대한 설정을 담고있습니다. 수정을 위해서 `sudo` 권한이 있는 사용자

또는 `root` 계정으로 접속해야합니다. 일반 사용자는 `sudo visudo`, `root 사용자` 는 그냥 `visudo` 명령어를

사용하시면 됩니다.



파일에서 아래 부분을 보면 권한을 실행할 수 있는 그룹이 보입니다. 기본적으로 wheel 그룹에 속한 사용자는 `sudo` 권한을

가지고있습니다. `sudo` 권한을 부여하기 위해서는 여기에 사용자의 그룹을 추가할 수도 있고, 특정 사용자을 `wheel` 그룹에

넣어주면 됩니다.



```sh
## Allows people in group wheel to run all commands
%wheel ALL=(ALL)   ALL
```





**journalctl -t sudo -f** 를 통해서 sudo 권한으로 실행한 명령어 로그를 확인하실 수 있습니다. 아래에

`sudo`  권한이 필요한 useradd, userdel 명령어를 실행했을때 , `sudo` 권한이 없는 경우 빨간색으로 로그가

찍히는것을 볼수있습니다.





